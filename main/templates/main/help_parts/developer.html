{% load i18n %}
{% load transformat %}
<div class="accordion-item">
    <div class="accordion-header">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-developer">
            {% trans 'main:help:developer:header' %}
        </button>
    </div>
    <div id="collapse-developer" class="collapse">
        <div class="p-3">
            <p>
                <i>This page requires some changes to your JavaScript. Feel free
                    to <a href="mailto:{{ labstaff_email }}">email</a> us if you
                    need assistance.</i>
            </p>
            <h3>JSPsych</h3>
            <p>
                If you are using one of our JSPsych boilerplates, we probably
                already have implemented this for you. Please see the
                documentation of your boilerplate for more information.
            </p>
            <p>
                If you are building your own JSPsych experiment, you can use our
                library. This library is also used by our boilerplates, and is
                guaranteed to work with this application.
            </p>
            <p>
                You can find out more about our
                <a href="https://github.com/UiL-OTS-labs/jspsych-uil-utils">
                    JSPsych utilities library at GitHub
                </a>
            </p>
            <h3>Generic implementation</h3>
            <p>
                To let your web-experiment upload data to this application, you
                will need to add a special function that uploads said data. Add
                the following function to your experiment's JavaScript.
            </p>
            <pre>
function saveData(data) {
  let access_key = "{YOUR ACCESS KEY HERE}"
  let xhr = new XMLHttpRequest();
  xhr.open('POST', 'https://experiment-datastore.lab.hum.uu.nl/api/' + access_key + '/upload/');
  xhr.setRequestHeader('Content-Type', 'text/plain'); // Don't change, server only accepts plain text
  xhr.send(data);
}
            </pre>
            <p>
                Remember to replace "{YOUR ACCESS KEY HERE}" with your key. This
                can be found on the details page of your experiment, under
                'Access Key'
            </p>
            <p>
                Finally, you need to call this function at the end of your
                experiment. This is done by calling `saveData` with the intended
                data:
            </p>
            <pre>
saveData(experiment_data);
            </pre>
            <p>
                It is recommended that your data is formatted as either a plain
                JavaScript object or a JSON string.
            </p>
        </div>
    </div>
</div>
